# Story 1.2: Implement Basic Video Import

## Status
Draft

## Story
**As a** user,
**I want** to import an MP4 or MOV video file into the application,
**so that** I can begin editing it.

## Acceptance Criteria
1. Application allows importing MP4/MOV via a native file picker.
2. Application allows importing MP4/MOV via drag and drop onto a designated area.
3. Successfully imported video file information (e.g., path, basic metadata if easily available) is stored internally.
4. No crashes occur with valid MP4/MOV files.

## Tasks / Subtasks
- [ ] Task 1: Create Video Import UI Components (AC: 1, 2)
  - [ ] Create ImportDialog component in apps/renderer/src/components/media/
  - [ ] Implement native file picker integration
  - [ ] Add drag and drop area for video files
  - [ ] Implement drag and drop event handlers
  - [ ] Add file drop validation for MP4/MOV
  - [ ] Create drag and drop visual feedback
  - [ ] Handle multiple file drops
  - [ ] Add drag and drop error handling
  - [ ] Create file type validation for MP4/MOV
- [ ] Task 2: Implement File System Service (AC: 3)
  - [ ] Create fileService.ts in apps/electron/src/services/
  - [ ] Implement file path validation
  - [ ] Add file metadata extraction
  - [ ] Handle file system errors gracefully
- [ ] Task 3: Create VideoClip Data Model (AC: 3)
  - [ ] Define VideoClip interface in packages/shared/src/types/
  - [ ] Implement video metadata extraction
  - [ ] Add file path and basic metadata storage
  - [ ] Create thumbnail path generation
- [ ] Task 4: Implement IPC Communication (AC: 1, 3)
  - [ ] Create IPC handlers in apps/electron/src/handlers/
  - [ ] Implement import-video IPC event
  - [ ] Add file-imported and file-import-error events
  - [ ] Create electronService.ts in apps/renderer/src/services/
- [ ] Task 5: Add Project State Management (AC: 3)
  - [ ] Create projectStore.ts with Zustand
  - [ ] Implement video clip storage
  - [ ] Add import state management
  - [ ] Handle import success/error states
- [ ] Task 6: Setup FFmpeg Binaries (AC: 1, 4) - **DEFERRED FROM STORY 1.1**
  - [ ] Download FFmpeg binaries to apps/electron/bin/
  - [ ] Configure FFmpeg binary permissions (chmod 777)
  - [ ] Set up FFmpeg path configuration
  - [ ] Test FFmpeg binary accessibility
- [ ] Task 7: Error Handling and Validation (AC: 4)
  - [ ] Implement file format validation
  - [ ] Add error handling for invalid files
  - [ ] Create user feedback for import status
  - [ ] Test with various MP4/MOV files

## Dev Notes

### Previous Story Insights
From Story 1.1: Basic Electron + React project structure is established with main window and build system.

### Data Models
**VideoClip Interface** [Source: architecture.md#data-models]:
```typescript
interface VideoClip {
  id: string;
  filePath: string;
  name: string;
  duration: number;
  width: number;
  height: number;
  fps: number;
  trimStart: number;
  trimEnd: number;
  thumbnailPath: string;
}
```

### API Specifications
**IPC Communication** [Source: architecture.md#api-specification]:
```typescript
// Renderer → Main Process Events
interface FileCommands {
  'import-video': { filePath: string };
}

// Main Process → Renderer Process Events
interface FileEvents {
  'file-imported': { clip: VideoClip };
  'file-import-error': { error: string };
}
```

### Component Specifications
**ImportDialog Component** [Source: architecture.md#unified-project-structure]:
- Location: apps/renderer/src/components/media/ImportDialog.tsx
- Props: onImport, onCancel, isOpen
- Features: File picker, drag & drop area, file validation, visual feedback
- Integration: Uses electronService for file operations
- Drag & Drop: Handles multiple file drops, validates MP4/MOV, provides visual feedback

**MediaLibrary Component** [Source: architecture.md#unified-project-structure]:
- Location: apps/renderer/src/components/media/MediaLibrary.tsx
- Purpose: Display imported video clips
- Integration: Connected to projectStore for state management

### File Locations
**Service Files** [Source: architecture.md#unified-project-structure]:
- apps/electron/src/services/fileService.ts
- apps/electron/src/handlers/ipcHandlers.ts
- apps/renderer/src/services/electronService.ts
- apps/renderer/src/stores/projectStore.ts

**Component Files**:
- apps/renderer/src/components/media/ImportDialog.tsx
- apps/renderer/src/components/media/MediaLibrary.tsx
- apps/renderer/src/components/media/ClipThumbnail.tsx

**Type Definitions**:
- packages/shared/src/types/video.ts
- packages/shared/src/types/project.ts

### Testing Requirements
**Testing Standards** [Source: architecture.md#tech-stack]:
- Manual testing for MVP
- Test file location: apps/electron/tests/ and apps/renderer/tests/
- Test cases: File import success, error handling, file validation
- Test data: Various MP4/MOV files of different sizes and formats

### Technical Constraints
**File Format Support** [Source: architecture.md#tech-stack]:
- Primary: MP4, MOV files
- Validation: File extension and basic metadata verification
- Error Handling: Graceful handling of invalid files

**IPC Communication** [Source: architecture.md#tech-stack]:
- Use Electron's built-in IPC for main ↔ renderer communication
- No HTTP requests - all communication via IPC events
- Proper error propagation from main to renderer process

**State Management** [Source: architecture.md#tech-stack]:
- Use Zustand for lightweight state management
- Store video clips in projectStore
- Maintain import status and error states

## Testing

### Testing Standards
- **Test Approach**: Manual testing for MVP
- **Test Location**: apps/electron/tests/ and apps/renderer/tests/
- **Test Framework**: Manual verification only
- **Key Test Cases**:
  - File picker opens and selects MP4/MOV files
  - Drag and drop functionality works correctly
  - Multiple files can be dropped simultaneously
  - Drag and drop visual feedback is displayed
  - Invalid file types are rejected with proper feedback
  - Video metadata is extracted correctly
  - Invalid files are handled gracefully
  - Import success/error states are displayed
  - No crashes occur with valid MP4/MOV files
  - Drag and drop error handling works properly
  - FFmpeg binaries are accessible and functional
  - FFmpeg path configuration works correctly

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-27 | 1.0 | Initial story creation | Scrum Master Bob |
| 2025-01-27 | 1.1 | Enhanced drag and drop implementation with comprehensive tasks and testing | Scrum Master Bob |
| 2025-01-27 | 1.2 | Added FFmpeg binary setup tasks deferred from Story 1.1 | Scrum Master Bob |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results
*Results from QA Agent review will be populated here*
